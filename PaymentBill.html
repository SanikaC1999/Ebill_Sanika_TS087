<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EBILL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="./images/logo.webp" type="image/x-icon">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        .main-section {
            text-align: center;
            padding: 100px 0;
            flex: 1;
        }

        .main-section h1 {
            font-size: 3rem;
            color: #6c63ff;
        }

        .main-section h2 {
            font-size: 1.5rem;
            margin: 20px 0;
        }

        .main-section .btn-explore {
            background-color: #6c63ff;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
        }

        .main-section img {
            max-width: 100%;
            height: auto;
            background: white;
        }

        .navbar {
            margin: 0 auto;
            padding: 0 1rem;
            width: 100%;
            display: flex;
            align-items: center;
            background-color: #ffffff;
        }

        .btn-outline-secondary,
        .btn-explore {
            background-color: #6c63ff;
            color: #ffffff;
            border-color: #6c63ff;
        }

        .btn-outline-secondary:hover,
        .btn-explore:hover {
            background-color: #ffffff;
            color: #6c63ff;
        }

        .navbar-nav .nav-link {
            color: #6c63ff;
            padding-right: 1rem;
            padding-left: 1rem;
        }

        .navbar-nav .nav-link:hover {
            color: blue;
            border-radius: 5px;
        }

        .card-custom {
            border: 4px solid #6c63ff;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            margin: 0 auto;
        }
        .toggle-box {
            display: none;
            position: absolute;
            top: 60px;
            right: 10px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .container-custom {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
        }

        .form-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .form-title {
            margin-bottom: 20px;
        }

        .form-image {
            width: 60px;
            height: 60px;
            margin-bottom: 20px;
        }

        .form-options {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .form-options .option img {
            width: 50px;
            height: 40px;
        }

        .hidden {
            display: none !important;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
        }

        .overlay img {
            max-width: 90%;
            max-height: 90%;
        }
    </style>
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="./images/logo.webp" alt="" width="60" height="60" class="d-inline-block align-text-top rounded-circle me-2">
                <h5 class="d-flex align-items-center" style="color: #6c63ff;">EBILL</h5>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link fw-bold" href="./index1_afterLogin.html">HOME</a></li>
                    <li class="nav-item">
                    <li class="nav-item">
                        <a class="nav-link fw-bold" href="./newConnection.html">NEW CONNECTION</a></li>
                    <li class="nav-item">
                        <li class="nav-item">
                            <a class="nav-link fw-bold" href="#" data-bs-toggle="modal" data-bs-target="#contactModal">CONTACT US</a>
                        </li>
                </ul>
                <button class="btn btn-outline-secondary ms-2 btn-explore" type="button" id="toggleButton" onclick="logout()">LOGOUT</button>
            </div>
        </div>
    </nav>
       
    <!-- Toggle box -->
    <!-- <div class="toggle-box" id="toggleBox">
        <p>Already a Ebill customer?</p>
        <button class="btn btn-outline-secondary me-2 rounded-pill ps-3 pe-3" type="button">Login</button>
        <button class="btn btn-outline-secondary rounded-pill ps-3 pe-3" type="button" style="background-color: #ccc;">Register</button>
        <a>
        <div class="card mt-3">
            <div class="card-body align-items-center">
                <button class="btn btn-outline-secondary rounded-pill ps-3 pe-3" type="button">LOGIN AS ADMIN</button>
            </div>
          </div>
        </a>
    </div> -->

    <!-- Main Section -->

    <div class="d-flex flex-column justify-content-center align-items-center vh-100 container-custom">
        <div class="form-container mt-2">
            <img src="./images/logo.webp" alt="Ebill Logo" class="form-image rounded-circle">
            <h2 class="form-title">Enter Account details</h2>
            <div class="form-options">
                <div class="option d-flex align-items-center">
                    <img src="./images/bill.webp" alt="Bill Payment">
                    <div>Bill Payment</div>
                </div>
            </div>
            <form id="PaymentForm">
                <div class="form-group">
                    <div class="row d-flex">
                        <label for="username" class="col justify-content-between">Consumer number</label>
                        <a href="#" id="sampleBillLink" class="col justify-content-between">Sample Bill</a>
                    </div>
                    <input type="text" class="form-control" id="username" name="Consumer name" required>
                </div>
                <div class="form-group">
                    <label for="units">Billing Units</label>
                    <input type="text" class="form-control" id="units" name="Billing units" required>
                </div>
                <div class="form-group">
                    <label for="phone">Nickname (Optional)</label>
                    <input type="text" class="form-control" id="phone" name="phone">
                </div>
                <button type="submit" class="btn btn-primary btn-block btn-explore mt-3">Continue</button>
                <button type="submit" id="showHistory" class="btn btn-primary btn-block btn-explore mt-3">Show Payment History</button>
            </form>
        
            <div class="table-responsive mt-3">
                <button id="backButton" class="btn btn-secondary mb-3 hidden">Back</button>
                <table class="table table-bordered hidden" id="resultTable">
                    <thead>
                        <tr>
                            <th>Consumer Name</th>
                            <th>Consumer Number</th>
                            <th>Units</th>
                            <th>Total Bill</th>
                            <th>Action</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
              <!-- Payment Options Section -->
<div class="form-container mt-2 hidden" id="paymentOptions">
    <h2 class="form-title">Select Payment Method</h2>
    <button id="creditDebitCardOption" class="btn btn-primary mb-2">Credit/Debit Card</button>
    <button id="upiOption" class="btn btn-primary mb-2">UPI</button>
</div>

<!-- Credit/Debit Card Payment Form -->
<div class="form-container mt-2 hidden" id="cardPaymentForm">
    <h2 class="form-title">Enter Card Details</h2>
    <form id="cardDetailsForm">
        <div class="form-group">
            <label for="cardNumber">Card Number</label>
            <input type="text" class="form-control" id="cardNumber" required>
        </div>
        <div class="form-group">
            <label for="cvv">CVV</label>
            <input type="text" class="form-control" id="cvv" required>
        </div>
        <button type="submit" class="btn btn-primary btn-block btn-explore mt-3">Continue</button>
    </form>
</div>

<!-- OTP Form -->
<div class="form-container mt-2 hidden" id="otpForm">
    <h2 class="form-title">OTP Verification</h2>
    <p>OTP has been sent to your registered mobile number.</p>
    <form id="otpVerificationForm">
        <div class="form-group">
            <label for="otp">Enter OTP</label>
            <input type="text" class="form-control" id="otp" required>
        </div>
        <button type="submit" class="btn btn-primary btn-block btn-explore mt-3">Pay</button>
    </form>
</div>

<!-- UPI Payment Form -->
<div class="form-container mt-2 hidden" id="upiPaymentForm">
    <h2 class="form-title">UPI Payment</h2>
    <button id="addUpiIdOption" class="btn btn-primary mb-2">Add UPI ID</button>
    <button id="scanQrCodeOption" class="btn btn-primary mb-2">Scan QR Code</button>
    <div class="form-group hidden" id="upiIdForm">
        <label for="upiId">UPI ID</label>
        <input type="text" class="form-control" id="upiId" required>
        <button type="submit" class="btn btn-primary btn-block btn-explore mt-3">Pay</button>
    </div>
    <div class="form-group hidden" id="qrCodeForm">
        <p>Scan this QR code with your UPI app.</p>
        <img src="./images/qr.jpeg" alt="QR Code" class="img-fluid" width="200px" height="200px">
    </div>
</div>
        </div>     
    </div>

    <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="contactModalLabel" style="color: #6c63ff;">Contact Us</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="contactForm">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="message" class="form-label">Feedback/Complaint</label>
                            <textarea class="form-control" id="message" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="background-color: #6c63ff; border-color: #6c63ff;">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay for Sample Bill -->
    <div class="overlay" id="overlay">
        <img src="./images/sampleBill.jpeg" alt="Sample Bill" id="sampleBillImage">
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>

    // Toggle box
    document.getElementById('toggleButton').addEventListener('click', function() {
        var toggleBox = document.getElementById('toggleBox');
        if (toggleBox.style.display === 'none' || toggleBox.style.display === '') {
            toggleBox.style.display = 'block';
        } else {
            toggleBox.style.display = 'none';
        }
    });

    // Hide toggle box when clicking outside
    document.addEventListener('click', function(event) {
        var toggleBox = document.getElementById('toggleBox');
        var toggleButton = document.getElementById('toggleButton');
        if (!toggleBox.contains(event.target) && !toggleButton.contains(event.target)) {
            toggleBox.style.display = 'none';
        }
    });

    // Display sample bill in overlay
    document.getElementById('sampleBillLink').addEventListener('click', function(event) {
        event.preventDefault();
        document.getElementById('overlay').style.display = 'flex';
    });

    // Hide sample bill overlay when clicking outside the image
    document.getElementById('overlay').addEventListener('click', function(event) {
        if (!document.getElementById('sampleBillImage').contains(event.target)) {
            document.getElementById('overlay').style.display = 'none';
        }
    });

document.getElementById('PaymentForm').addEventListener('submit', function(event) {
    event.preventDefault();

    let consumerName = document.getElementById('username').value;
    let billingUnits = document.getElementById('units').value;
    let phone = document.getElementById('phone').value;

    // Validation logic
    let isValid = true;
    let errorMessage = '';

    // Validate consumer number
    if (!/^\d{12}$/.test(consumerName)) {
        isValid = false;
        errorMessage += 'Consumer number must be exactly 12 digits.\n';
    }

    // Validate units
    if (!/^\d+$/.test(billingUnits)) {
        isValid = false;
        errorMessage += 'Units must be a number.\n';
    }

    if (!isValid) {
        alert(errorMessage);
    } else {
        // Retrieve existing payment data from local storage
        let paymentDataArray = JSON.parse(localStorage.getItem('paymentDataArray')) || [];

        // Save payment data
        let paymentData = {
            consumerName: consumerName,
            billingUnits: billingUnits,
            phone: phone
        };

        paymentDataArray.push(paymentData);
        localStorage.setItem('paymentDataArray', JSON.stringify(paymentDataArray));
        alert('Payment data saved!');

        // Attach a random name
        var names = JSON.parse(localStorage.getItem('names'));
        var randomName = names[Math.floor(Math.random() * names.length)];

        // Calculate bill
        var billAmount = calculateBill(billingUnits);

        // Display result in the table
        var tableBody = document.getElementById('resultTable').querySelector('tbody');
        var newRow = tableBody.insertRow();
        newRow.innerHTML = `
            <td>${randomName}</td>
            <td>${consumerName}</td>
            <td>${billingUnits}</td>
            <td>₹${billAmount}</td>
            <td><button class="btn btn-primary btn-sm">Pay Bill Now</button></td>
        `;

        document.getElementById('PaymentForm').reset();
        document.getElementById('resultTable').classList.remove('hidden');
        document.getElementById('PaymentForm').classList.add('hidden');
        document.getElementById('backButton').classList.remove('hidden');
    }
});

// Function to calculate bill based on units
function calculateBill(units) {
    // Implement your bill calculation logic here
    // For demonstration purposes, let's assume a simple rate
    let ratePerUnit = 5; // Example rate per unit
    return units * ratePerUnit;
}

// Load existing payment data and display in the table on page load
window.addEventListener('load', function() {
    let paymentDataArray = JSON.parse(localStorage.getItem('paymentDataArray')) || [];
    var tableBody = document.getElementById('resultTable').querySelector('tbody');

    paymentDataArray.forEach(function(paymentData) {
        // Attach a random name
        var names = JSON.parse(localStorage.getItem('names'));
        var randomName = names[Math.floor(Math.random() * names.length)];

        // Calculate bill
        var billAmount = calculateBill(paymentData.billingUnits);

        // Display result in the table
        var newRow = tableBody.insertRow();
        newRow.innerHTML = `
            <td>${randomName}</td>
            <td>${paymentData.consumerName}</td>
            <td>${paymentData.billingUnits}</td>
            <td>₹${billAmount}</td>
            <td><button class="btn btn-primary btn-sm">Pay Bill Now</button></td>
        `;
    });

    if (paymentDataArray.length > 0) {
        document.getElementById('resultTable').classList.remove('hidden');
    }

    document.getElementById('resultTable').classList.add('hidden');
    document.getElementById('showHistory').classList.remove('hidden')

});


// Function to calculate bill based on units
function calculateBill(units) {
    // Implement your bill calculation logic here
    // For demonstration purposes, let's assume a simple rate
    let ratePerUnit = 5; // Example rate per unit
    return units * ratePerUnit;
}

document.getElementById('backButton').addEventListener('click', function() {
    document.getElementById('resultTable').classList.add('hidden');
    document.getElementById('PaymentForm').classList.remove('hidden');
    document.getElementById('backButton').classList.add('hidden')
    document.getElementById('showHistory').classList.remove('hidden')
});

document.getElementById('showHistory').addEventListener('click' , function(){
    document.getElementById('resultTable').classList.remove('hidden');
    document.getElementById('PaymentForm').classList.add('hidden');
    document.getElementById('backButton').classList.remove('hidden')
    document.getElementById('showHistory').classList.add('hidden')
})

// Handle "Pay Bill Now" button click
document.querySelector('tbody').addEventListener('click', function(event) {
    if (event.target && event.target.classList.contains('btn-sm')) {
        document.getElementById('resultTable').classList.add('hidden');
        document.getElementById('paymentOptions').classList.remove('hidden');
        document.getElementById('backButton').classList.add('hidden'); // Hide the back button when moving to payment options
    }
});

// Handle payment options
document.getElementById('creditDebitCardOption').addEventListener('click', function() {
    document.getElementById('paymentOptions').classList.add('hidden');
    document.getElementById('cardPaymentForm').classList.remove('hidden');
});

document.getElementById('upiOption').addEventListener('click', function() {
    document.getElementById('paymentOptions').classList.add('hidden');
    document.getElementById('upiPaymentForm').classList.remove('hidden');
});

// Handle card payment form submission
document.getElementById('cardDetailsForm').addEventListener('submit', function(event) {
    event.preventDefault();
    document.getElementById('cardPaymentForm').classList.add('hidden');
    document.getElementById('otpForm').classList.remove('hidden');
});

// Handle OTP form submission
document.getElementById('otpVerificationForm').addEventListener('submit', function(event) {
    event.preventDefault();
    alert('Payment successful!');
    document.getElementById('otpForm').classList.add('hidden');
    document.getElementById('PaymentForm').classList.remove('hidden');
    document.getElementById('backButton').classList.add('hidden'); // Ensure back button is hidden when form is shown
});

// Handle UPI payment options
document.getElementById('addUpiIdOption').addEventListener('click', function() {
    document.getElementById('upiIdForm').classList.remove('hidden');
    document.getElementById('qrCodeForm').classList.add('hidden');
});

document.getElementById('scanQrCodeOption').addEventListener('click', function() {
    document.getElementById('upiIdForm').classList.add('hidden');
    document.getElementById('qrCodeForm').classList.remove('hidden');
});

// Handle UPI ID form submission
document.getElementById('upiIdForm').addEventListener('submit', function(event) {
    event.preventDefault();
    alert('Payment successful!');
    document.getElementById('upiPaymentForm').classList.add('hidden');
    document.getElementById('PaymentForm').classList.remove('hidden');
    document.getElementById('backButton').classList.add('hidden'); // Ensure back button is hidden when form is shown
});

    // Logout function
    function logout() {
        localStorage.removeItem('formDataArray');
        localStorage.removeItem('contactData');
        alert('You have been logged out!');
        window.location.href = './index.html'; // Redirect to the login page
    }

    </script>
</body>
</html>
